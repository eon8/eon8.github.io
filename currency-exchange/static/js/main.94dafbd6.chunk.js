(this["webpackJsonpcurrency-exchange"]=this["webpackJsonpcurrency-exchange"]||[]).push([[0],{20:function(e,t,r){e.exports=r(35)},30:function(e,t,r){},31:function(e,t,r){},32:function(e,t,r){},33:function(e,t,r){},34:function(e,t,r){},35:function(e,t,r){"use strict";r.r(t);var n,o=r(0),a=r.n(o),c=r(11),i=r.n(c),u=r(5),s=r(3),l=r(4),p=r(9),f=r(8),m=r(10),v="SELECT_POCKET",d="SET_AMOUNT";function h(e,t,r){return{type:d,payload:{fromAmount:e,toAmount:t,valid:r}}}!function(e){e.FROM="from",e.TO="to"}(n||(n={}));var y="POCKET_TOP_UP",O="POCKET_WITHDRAW";var b=r(16),g=r(1);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(r,!0).forEach((function(t){Object(g.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P="",A="0.00",C={fromAmount:P,toAmount:A,valid:!1};var w=r(15),k=r.n(w),N=function(){function e(t,r){Object(s.a)(this,e),this.currency=t,this.balance=void 0,this.balance=new k.a(r||"0.00")}return Object(l.a)(e,[{key:"getType",value:function(){return this.currency}},{key:"getAmount",value:function(){return this.balance.toFixed(2)}},{key:"topUp",value:function(e){var t=this.normalize(e);return this.balance=this.balance.add(t),this}},{key:"withdraw",value:function(e){var t=this.normalize(e);if(t.greaterThan(this.balance))throw new Error("Amount is greater that balance");return this.balance=this.balance.sub(t),this}},{key:"convert",value:function(t,r){return new e(t,this.balance.mul(r).toFixed(2))}},{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return"".concat(this.currency.sign).concat(this.balance.toFixed(e))}},{key:"normalize",value:function(e){var t=new k.a(e);if(t.isNegative())throw new Error("Amount cannot be negative");return t}}]),e}(),T="FETCH_RATES_START",F="FETCH_RATES_SUCCESS",S="FETCH_RATES_FAIL",D="FETCH_RATES_STOP";var R,I=1e4;var M=function e(t){return function(r,n){clearTimeout(R),r(function(e){return{type:T,payload:{currencyCode:e}}}(t)),fetch("https://api.exchangeratesapi.io/latest?base="+t).then((function(e){return e.json()})).then((function(o){r(function(e,t){return{type:F,payload:{currencyCode:e,data:t}}}(t,o.rates));var a=n();console.log(a),a.converter.from&&a.converter.from.code===t?R=setTimeout((function(){r(e(t))}),I):r(function(e){return{type:D,payload:{currencyCode:e}}}(t))})).catch((function(e){r(function(e,t){return{type:S,payload:{currencyCode:e,error:t}}}(t,e))}))}},U=(r(30),function(e){function t(){var e,r;Object(s.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(r=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(a)))).input=null,r.onChange=function(e){return function(t){r.updateAmounts(e,t.target.value)}},r.onKeyPress=function(e){13===e.charCode&&r.props.propagateConvert()},r.updateAmounts=function(e,t){var o,a=(o={},Object(g.a)(o,n.FROM,"-"),Object(g.a)(o,n.TO,"+"),o);if(t&&t[0]===a[e]&&(t=t.slice(1)),t&&"."===t[0]&&(t="0."+t.slice(1,3)),!t||t.match(/^\d+(\.\d{0,2})?$/)){var c,i;e===n.FROM?(c=t,i=new N(r.props.from,t).convert(r.props.to,r.props.rate).getAmount()):(i=t,c=new N(r.props.to,t).convert(r.props.from,1/r.props.rate).getAmount());var u=parseFloat(c)>0&&parseFloat(c)<=parseFloat(r.props.fromBalance);r.props.setAmounts(c,i,u)}},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t,r){!this.input||e.from===this.props.from&&e.to===this.props.to&&e.fromBalance===this.props.fromBalance||this.input.focus()}},{key:"render",value:function(){var e=this.props,t=e.currency,r=e.balance,n=new N(t,r).format();return a.a.createElement("div",{className:"PocketInput"},a.a.createElement("div",{className:"PocketInput-top"},a.a.createElement("div",{className:"nowrap noshrink clickable",onClick:this.props.change},t.code),this.renderValue()),a.a.createElement("div",{className:"PocketInput-bottom"},a.a.createElement("span",{className:"nowrap"},"You have ",n),this.renderRate()))}},{key:"renderValue",value:function(){var e=this,t=this.props,r=t.slot,o=t.from,c=t.to,i=t.rate,u=t.fromAmount,s=t.toAmount,l=t.valid;if(!o||!c||!i)return null;var p=r===n.FROM&&parseFloat(u)&&!l;return a.a.createElement("input",{className:"PocketInput-field"+(p?" invalid":""),value:r===n.FROM?u:s,onChange:this.onChange(r),onKeyPress:this.onKeyPress,ref:function(t){r===n.FROM&&(e.input=t)}})}},{key:"renderRate",value:function(){var e=this.props,t=e.slot,r=e.from,o=e.currency,c=e.rate;if(!(t===n.TO&&r&&c))return null;var i=new N(r,"1").format(0),u=new N(o,"".concat(c)).format(4);return a.a.createElement("span",{className:"nowrap"},i," = ",u)}}]),t}(a.a.Component)),_={setAmounts:h},x=Object(u.b)((function(e){var t,r=e.converter,n=r.from,o=r.to,a=r.fromAmount,c=r.toAmount,i=r.valid,u=n&&e.pockets[n.code]||"0";if(n&&o){var s=e.rates[n.code];s&&s.data&&s.data[o.code]&&(t=s.data[o.code])}return{from:n,to:o,fromBalance:u,rate:t,fromAmount:a?"-"+a:"",toAmount:c?"+"+c:"",valid:i}}),_)(U),G=(r(31),function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(r=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={isChanging:!1},r.renderOption=function(e){return a.a.createElement("div",{className:"Pocket-list-item",key:e.code,onClick:r.select(e)},e.title,"\xa0",a.a.createElement("small",null,"(",new N(e,r.props.pockets[e.code]).format(),")"))},r.change=function(){r.setState({isChanging:!0}),document.addEventListener("click",r.close)},r.select=function(e){return function(t){t.stopPropagation(),r.props.selectPocket(r.props.slot,e),r.close()}},r.close=function(){r.setState({isChanging:!1}),document.removeEventListener("click",r.close)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.isChanging,t=this.props,r=t.slot,o=t.currency,c=t.currencies,i=t.balance,u=t.propagateConvert;return a.a.createElement("div",{className:"Pocket"},e?a.a.createElement("div",{className:"Pocket-list"},c.map(this.renderOption)):o?a.a.createElement(x,{slot:r,currency:o,balance:i,change:this.change,propagateConvert:u}):a.a.createElement("div",{className:"Pocket-select",onClick:this.change},"Select ",r===n.FROM?"source":"destination"," pocket"))}}]),t}(a.a.Component)),B=Object(u.b)((function(e,t){var r=e.pockets,n=Object.values(e.currencies),o=e.converter[t.slot];return{pockets:r,currencies:n,currency:o,balance:o?e.pockets[o.code]:void 0}}),(function(e){return{selectPocket:function(t,r){e(function(e,t){return{type:v,payload:{slot:e,currency:t}}}(t,r)),t===n.FROM&&e(M(r.code))}}}))(G),H=(r(32),function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).convert=function(){var e=r.props,t=e.valid,n=e.from,o=e.to,a=e.fromAmount,c=e.toAmount;n&&o&&t&&r.props.convert(n,o,a,c)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.valid;return a.a.createElement("div",null,a.a.createElement("div",{className:"Converter"},a.a.createElement("div",{className:"Converter-line"},a.a.createElement(B,{slot:n.FROM,propagateConvert:this.convert})),a.a.createElement("div",{className:"Converter-line"},a.a.createElement(B,{slot:n.TO,propagateConvert:this.convert}))),e?a.a.createElement("button",{className:"Converter-button",onClick:this.convert},"Convert"):null)}}]),t}(a.a.Component)),K=Object(u.b)((function(e){var t=e.converter;return{from:t.from,to:t.to,fromAmount:t.fromAmount,toAmount:t.toAmount,valid:t.valid}}),(function(e){return{convert:function(t,r,n,o){e({type:O,payload:{currency:t,amount:n}}),e(function(e,t){return{type:y,payload:{currency:e,amount:t}}}(r,o)),e(h(P,A,!1))}}}))(H),L=(r(33),function(){return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"App-header"},a.a.createElement("h1",{className:"App-title"},"Exchange")),a.a.createElement("div",{className:"App-body"},a.a.createElement(K,null)))}),J=(r(34),r(6)),z=r(19),Y={USD:{code:"USD",sign:"$",title:"US dollar"},EUR:{code:"EUR",sign:"\u20ac",title:"Euro"},GBP:{code:"GBP",sign:"\xa3",title:"Pound sterling"},JPY:{code:"JPY",sign:"\xa5",title:"Japanese yen"},CAD:{code:"CAD",sign:"C$",title:"Canadian dollar"}};function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(r,!0).forEach((function(t){Object(g.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var W,q={USD:(4900*Math.random()+100).toFixed(2),EUR:(3950*Math.random()+50).toFixed(2),GBP:(3e3*Math.random()).toFixed(2)};function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(r,!0).forEach((function(t){Object(g.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.FETCHING="fetching",e.PENDING="pending",e.SLEEPING="sleeping"}(W||(W={}));var Z={};var ee=Object(J.c)({currencies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return arguments.length>1&&arguments[1],e},converter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:var r=t.payload,o=r.slot,a=r.currency,c=e;if(o===n.FROM){if(c=j({},e,{from:a}),e.to&&e.to.code===a.code){var i=c;i.to;c=Object(b.a)(i,["to"])}}else if(c=j({},e,{to:a}),e.from&&e.from.code===a.code){var u=c;u.from;c=Object(b.a)(u,["from"])}return j({},c,{fromAmount:P,toAmount:A});case d:var s=t.payload;return j({},e,{fromAmount:s.fromAmount,toAmount:s.toAmount,valid:s.valid})}return e},pockets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:var r=t.payload,n=r.currency,o=r.amount,a=e[n.code];return V({},e,Object(g.a)({},n.code,new N(n,a).topUp(o).getAmount()));case O:var c=t.payload,i=c.currency,u=c.amount,s=e[i.code];return V({},e,Object(g.a)({},i.code,new N(i,s).withdraw(u).getAmount()))}return e},rates:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:var r=t.payload.currencyCode;return X({},e,Object(g.a)({},r,X({},e[r],{status:W.FETCHING})));case F:var n=t.payload,o=n.currencyCode,a=n.data;return X({},e,Object(g.a)({},o,X({},e[o],{status:W.PENDING,data:a})));case S:var c=t.payload,i=c.currencyCode,u=c.error;return X({},e,Object(g.a)({},i,X({},e[i],{status:W.PENDING,error:u})));case D:var s=t.payload.currencyCode;return X({},e,Object(g.a)({},s,X({},e[s],{status:W.SLEEPING,error:void 0})))}return e}}),te=Object(J.d)(ee,Object(J.a)(z.a));i.a.render(a.a.createElement(u.a,{store:te},a.a.createElement(L,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.94dafbd6.chunk.js.map